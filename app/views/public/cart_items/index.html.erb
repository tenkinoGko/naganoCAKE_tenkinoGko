<div class="container">
  <div class="row my-3">
    <% if @cart_items.blank? %>
      <div class="col-md-8 text-center">
        <h3>カート内に商品はございません</h3>
        <%= link_to "買い物を続ける", items_path, class:"btn btn-primary" %>
      </div>
    <% else %>
      <div class="col-md-10">
        <div class="col-sm-8 px-sm-0 offset-sm-1">
          <h5>ショッピングカート</h5>
        </div>
        <div class="row justify-content-end">
          <div class="col-sm-2 px-sm-0">
            <%= link_to "カートを空にする", cart_items_destroy_all_path, method: :delete, class:"btn btn-sm btn-danger", "data-confirm" => "本当に空にしますか？" %>
          </div>
          <table class="table table-hover table-inverse table-bordered custom-table">
            <thead class="thead-light">
              <tr align=center>
                <th scope="col" style="width:40">商品名</th>
                <th scope="col" style="width:10">単価(税込)</th>
                <th scope="col" style="width:20">数量</th>
                <th scope="col" style="width:10">小計</th>
                <th scope="col" style="width:10"><br></th>
              </tr>
            </thead>
            <tboby>
              <% @sum = 0 %>
              <% @cart_items.each do |cart_item| %>
                <tr id="cart_item_<%= cart_item.id %>">
                  <td class="align-middle"><%= image_tag cart_item.item.image, size: "100x100", class: "p-2 image" %> <%= cart_item.item.name %></td>
                  <td class="align-middle text-center"><%= cart_item.item.price %></td>
                  <td id="select-form" class="align-middle">
                    <%= form_with model: cart_item, url:cart_item_path(cart_item), local: true do |f| %>
                      <%= f.select :amount, *[1..10] %>
                      <%= f.submit "変更", class:"btn btn-sm btn-success" %>
                    <% end %>
                  </td>
                  <td class="align-middle subtotal-area text-center"><%= number_with_delimiter(cart_item.subtotal) %></td>
                  <td class="align-middle text-center"><%= link_to "削除", cart_item_path(cart_item.id), method: :delete, class:"btn btn-sm btn-danger", "data-confirm" => "商品を削除しますか？" %></td>
                </tr>
                <% @sum += cart_item.subtotal %>
              <% end %>
            </tboby>
          </table>
        </div>
      </div>
      <div class="row row-content-middle mt-3">
        <div class="col-sm-7 px-sm-0 offset-sm-2">
          <%= link_to "買い物を続ける", root_path, class:"btn btn-primary" %>
        </div>
        <div class="col-md-2 text-right">
          <table class="table table-hover table-inverse table-bordered">
            <tbody>
              <tr align="center">
                <th class="table-active", style="width:50%">合計金額</th>
                <td style="width:50%"><%= @sum.to_s(:delimited) %></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="row mt-5 row-content">
        <div class="col-md-12 text-center">
          <%= link_to "情報入力に進む", new_order_path, class:"btn btn-sm btn-success" %>
        </div>
      </div>
    <% end %>
  </div>
</div>
